- id: 'Включить вытяжку в ванной при высокой влажности и выключенном свете'
  alias: ba_enable_venting_on_high_humidity
  trigger:
    - platform: state
      entity_id: binary_sensor.ba_high_humidity
      to: 'on'
  condition:
    - condition: state
      entity_id: light.ba_light
      state: 'off'
  action:
    - service: switch.turn_on
      entity_id: switch.ba_venting

- id: 'Выключить вытяжку в ванной при нормальной влажности (на 5% выше, чем в спальне)'
  alias: ba_disable_venting_on_normal_humidity
  trigger:
    - platform: state
      entity_id: binary_sensor.ba_normal_humidity
      to: 'on'
  action:
    - service: switch.turn_off
      entity_id: switch.ba_venting

- id: 'Включить вытяжку в ванной при высокой влажности вместе с выключением света'
  alias: ba_enable_venting_on_high_humidity_with_light_off
  trigger:
    - platform: state
      entity_id: light.ba_light
      to: 'off'
  condition:
    - condition: state
      entity_id: binary_sensor.ba_high_humidity
      state: 'on'
  action:
    - service: switch.turn_on
      entity_id: switch.ba_venting

- id: 'Включить вытяжку в ванной при очень высокой влажности'
  alias: ba_enable_venting_on_very_high_humidity
  trigger:
    - platform: state
      entity_id: binary_sensor.ba_very_high_humidity
      to: 'on'
  action:
    - service: switch.turn_on
      entity_id: switch.ba_venting

- id: 'Сбросить сенсоры влажности при ошибочном выключении вытяжки'
  alias: ba_reset_humidity_sensors_on_erroneous_venting_disable
  trigger:
    - platform: state
      entity_id: switch.ba_venting
      to: 'off'
  action:
    - service: python_script.set_state
      data_template:
        entity_id: binary_sensor.ba_high_humidity
        state: 'off'
    - service: python_script.set_state
      data_template:
        entity_id: binary_sensor.ba_very_high_humidity
        state: 'off'
